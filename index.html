<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>GESTÃO DE RFS NO SAURON</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@800&family=Quicksand:wght@600&display=swap" rel="stylesheet">
  <style>
    /* ... (todo o seu CSS permanece igual, não alterei nada) ... */
    :root {
      --main-bg: #f8f9fc;
      --card-bg: #fff;
      --border: #b6b7ca;
      --border-dark: #7979a2;
      --num-ok: #1976d2;
      --num-t5: #c86f2f;
      --num-t4: #17527e;
      --num-t3: #8e2fc8;
      --num-t2: #dcad23;
      --num-t1: #2fc877;
      --num-alt: #c82f3c;
      --num-info: #245392;
      --num-warn: #b08900;
      --title: #232339;
      --text: #272738;
      --muted: #789;
      --sauron: #554eee;
      --focus-bg: #e9f0fc;
      --acrd-header-bg: #f4f5fa;
      --acrd-header-hover: #ececff;
      --shadow-dense: 0 4px 32px #473ebc21, 0 1.5px 6px #554eee14;
      --shadow-card-hover: 0 8px 32px #302ad91c, 0 1.5px 10px #554eee26;
      --shadow-inset: 0 0 0.5px 1.5px #b8aaff11;
      --tr: .25s cubic-bezier(.66, .02, .27, 1.32);

      /* Novas cores para RFs Emprestados - áreas */
      --color-packing: #4CAF50; /* Verde */
      --color-shipping: #FFC107; /* Amarelo */
      --color-retiro: #00BCD4; /* Ciano */
      --color-putwall: #9C27B0; /* Roxo */
      --color-putaway: #FF5722; /* Laranja */
      --color-returns: #F44336; /* Vermelho */
      --color-inventario: #607D8B; /* Cinza azulado */
      --color-qualidade: #2196F3; /* Azul */
      --color-indiretos-picking: #795548; /* Marrom */
    }
    html, body {
      min-height:100%;
      margin:0;
      padding:0;
      background: var(--main-bg);
      color: var(--text);
      font-family: 'Montserrat', 'Quicksand', Arial, sans-serif;
      box-sizing: border-box;
      font-size: 16px;
    }
    body { position: relative;}
    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1100px;
      margin: 0 auto 0 auto;
      padding-left: 0;
      padding-right: 16px;
      min-height: 80px;
      gap: 10px;
    }
    header {
      text-align: left;
      padding:24px 0 10px 0;
      font-size: 2.95rem;
      font-family: 'Montserrat', sans-serif;
      font-weight: 900;
      color: var(--sauron);
      letter-spacing: 2.5px;
      text-transform: uppercase;
      background: none;
      border-bottom: 0;
      margin-bottom:0;
      text-shadow:
          0 0 6px #b2b1ff88,
          0 0 24px #d9d6fe99,
          0 0 2px #7c7df099;
      flex-grow: 1;
      transition: color var(--tr), text-shadow var(--tr);
    }
    header:hover, header:focus {
      color: #3d379e;
      text-shadow:
          0 0 18px #a79cff5c,
          0 0 35px #554eeeab;
    }
    .btn-resumo {
      background: var(--sauron);
      color: #fff;
      font-size: 1rem;
      letter-spacing:1.1px;
      font-family: 'Montserrat', Arial, sans-serif;
      font-weight: bold;
      border: none;
      border-radius: 2.1em;
      padding: 9px 22px 9px 18px;
      margin:0;
      box-shadow:0 5px 24px #554eee24, 0 1.5px 6px #20116e18;
      cursor:pointer;
      transition:background var(--tr), box-shadow var(--tr), transform .13s cubic-bezier(.33,1.3,.33,1), color .16s;
      position:relative;
      display: flex;
      align-items: center;
      gap:8px;
      outline: none;
      flex-shrink: 0;
    }
    .btn-resumo:active, .btn-resumo:focus, .btn-resumo:hover {
      background: #271bc3;
      color:#fff;
      box-shadow:0 8px 32px #554eee33, 0 4px 24px #271bc366;
      transform: translateY(-2px) scale(1.03);
    }
    .btn-resumo .ic { font-size:1.26em; vertical-align:middle; filter: drop-shadow(0 1px 2px #b2b1ff33);}
    .btn-small {
      font-size: 0.92rem;
      padding: 7px 14px 7px 12px;
      border-radius: 1.6em;
      min-width: 0;
      box-shadow:0 4px 18px #554eee17, 0 1px 2.5px #554eee10;
      transition: background var(--tr), box-shadow var(--tr), transform .18s;
    }
    .btn-small:hover, .btn-small:focus {
      background: #271bc3;
      color:#fff;
      box-shadow:0 6px 22px #554eee37, 0 1.5px 6px #554eee10;
      transform: translateY(-1.5px) scale(1.035);
    }
    .btn-small .ic {
      font-size: 1.05em;
      filter: drop-shadow(0 1px 1.5px #e9e6fe44);
    }
    .top-highlight-sauron {
      max-width:340px;
      margin: 16px auto 24px auto;
      background: linear-gradient(105deg,#efedfe 64%,#ddeaff 115%);
      border: 3.5px solid var(--border-dark);
      box-shadow: 0 9px 36px #b8b5f333, var(--shadow-inset);
      border-radius: 18px;
      padding: 18px 18px 15px 18px;
      text-align:center;
      position: relative;
      transition: box-shadow var(--tr), border-color var(--tr), background var(--tr);
    }
    .top-highlight-sauron:hover, .top-highlight-sauron:focus {
      border-color: var(--sauron);
      box-shadow: 0 14px 52px #554eee33, 0 0 0 3px #7c7df04a;
      background: linear-gradient(104deg,#f7f6fe 54%,#dbe6ff 100%);
    }
    .top-highlight-sauron-label {
      font-size: 1.09em;
      letter-spacing:2px;
      color: var(--sauron);
      font-weight: 850;
      text-transform: uppercase;
      font-family: 'Montserrat',Arial,sans-serif;
      margin-bottom: 1px;
      text-shadow: 0 2px 10px #e9e8fb45;
      transition: color var(--tr), text-shadow var(--tr);
    }
    .top-highlight-sauron-num {
      font-size: 4.8em;
      font-weight: 900;
      color: var(--sauron);
      letter-spacing: 2px;
      text-shadow: 0 2px 19px #b2b5fe75, 0 1px 1px #fff, 0 0 10px #c8c5ff33;
      margin-top: 7px;
      margin-bottom: 0;
      font-family: 'Montserrat',Arial,sans-serif;
      line-height:1.06em;
      display:inline-block;
      padding:0 0.15em;
      transition: color var(--tr), text-shadow var(--tr), transform .18s cubic-bezier(.71,1.2,.44,.96);
    }
    .top-highlight-sauron-num:hover,
    .top-highlight-sauron-num:focus {
      color: #3e2aaa;
      text-shadow: 0 4px 25px #b2b5fe99, 0 2px 2px #fff;
      transform: scale(1.07) skewY(-3deg);
    }

    /* NOVO Estilo data/hora centralizado & destacado */
    #datahora {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 9px;
      margin-left: auto;
      margin-right: auto;
      font-size: 1.19em;
      font-weight: 700;
      color: var(--title);
      box-shadow: 0 2px 12px #b2b5fe1f, 0 1px 3px #aaaaff15;
      border-width: 2.4px;
      min-width: 270px;
      max-width: 96vw;
      letter-spacing: 0.8px;
      text-align: center;
      margin-top: 13px;
      /* >>> removendo Borda (não há border, está no .databox) <<< */
    }
    #datahora .icone {
      font-size: 1.38em;
      opacity: 0.69;
      margin-right: 4px;
      vertical-align: middle;
    }
    /* Fim NOVO estilo databox datahora */

    .databox {
      font-size:1em;
      color: var(--muted);
      margin:8px 0 19px 0;
      display:inline-block;
      background: #f3f4f7;
      padding:4px 14px;
      border-radius:8px;
      user-select:all;
      font-weight:normal;
      letter-spacing:1px;
      border: 1.8px solid var(--border-dark);
      box-shadow: 0 1px 8px #c2c2df13, 0 1px 2px #eaeaed07;
      transition: border var(--tr), box-shadow var(--tr), background var(--tr);
    }
    .databox:hover, .databox:focus { background: #f7f8ff; border-color: var(--sauron); box-shadow:0 4px 16px #b2b5fe18;}
    .dashboard-main {
      max-width: 890px;
      margin: 0 auto 40px auto;
      padding:0 0 30px 0;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      gap: 19px;
      transition: filter .2s cubic-bezier(1,.05,.41,1.12);
    }
    .dashboard-main.blurred,
    .top-bar.blurred,
    .top-highlight-sauron.blurred,
    .databox.blurred {
      filter: blur(4px) brightness(0.96) grayscale(0.1);
      pointer-events: none;
      user-select: none;
    }
    .accordion {
      display: flex;
      flex-direction: column;
      gap: 17px;
    }
    .acrd-card {
      background: var(--card-bg);
      border-radius: 13px;
      border: 2.2px solid var(--border-dark);
      box-shadow: var(--shadow-dense);
      margin-bottom:0;
      overflow: hidden;
      transition: box-shadow var(--tr), border-color var(--tr), transform .23s cubic-bezier(.81,1.91,.47,1);
    }
    .acrd-card.active,
    .acrd-card:hover,
    .acrd-card:focus-within {
      border-color: var(--num-ok);
      box-shadow: var(--shadow-card-hover), 0 0 0 2.5px #1976d220;
      transform: translateY(-2px) scale(1.01);
    }
    .acrd-header {
      cursor: pointer;
      background:var(--acrd-header-bg);
      padding: 18px 25px;
      display: flex;
      align-items: center;
      user-select: none;
      border:none;
      border-bottom:1.3px solid var(--border-dark);
      font-weight: 900;
      font-size: 1.13em;
      letter-spacing:.6px;
      color: var(--title);
      font-family: 'Montserrat', Arial, sans-serif;
      outline: none;
      transition:background var(--tr), color var(--tr), box-shadow var(--tr);
      width:100%;
      box-shadow: 0 1px 0 #edeafc1e;
    }
    .acrd-header:focus, .acrd-header:hover {
      background: var(--acrd-header-hover);
      color: var(--sauron);
      box-shadow: 0 3px 11px #554eee1d;
    }
    .acrd-header .arrow {
      font-size: 1.25em;
      margin-right: 14px;
      transition:transform .22s cubic-bezier(.5,1.6,.33,1),
                  color var(--tr);
      color: var(--num-ok);
      min-width: 15px;
      filter: drop-shadow(0 1.5px 2.5px #b1dcff60);
    }
    .acrd-header.collapsed .arrow { transform: rotate(-90deg); color: var(--border-dark);}
    .acrd-body {
      padding: 18px 24px 13px 32px;
      animation: fadein .18s;
      background:transparent;
      transition: background var(--tr);
    }
    @keyframes fadein {
      from { opacity: 0; transform: translateY(-10px);}
      to  { opacity: 1; transform:translateY(0);}
    }
    .fieldsetDMO {
      display:flex; flex-direction:column; gap:18px; position:relative;
    }
    .campo-t1, .campo-t2, .campo-t3, .campo-t4, .campo-t5, .campo-sauron,
    .campo-emprestado, .campo-packing, .campo-shipping, .campo-retiro,
    .campo-putwall, .campo-putaway, .campo-returns, .campo-inventario,
    .campo-qualidade, .campo-indiretos-picking {
      border-radius: 7px;
      margin-bottom:5px;
      padding:8px 10px 8px 18px;
      font-size:1.02em;
      border:1.4px solid var(--border-dark);
      box-shadow:0 2px 8px #e4e4fc10;
      transition: box-shadow var(--tr), border var(--tr);
    }
    .campo-t1 {border-left: 6px solid var(--num-t1);background: #e4fff1;}
    .campo-t2 {border-left: 6px solid var(--num-t2);background: #fffbe4;}
    .campo-t3 {border-left: 6px solid var(--num-t3);background: #f9e4ff;}
    .campo-t4 {border-left: 6px solid var(--num-t4);background: #e6f0fb;}
    .campo-t5 {border-left: 6px solid var(--num-t5);background: #fffae4;}
    .campo-sauron {border-left: 6px solid var(--sauron);background: #efedfe;}
    .campo-emprestado {border-left: 6px solid var(--num-info);background: #e6f7ff;} /* Novo estilo para RFs emprestados */

    /* Estilos para as novas áreas */
    .campo-packing {border-left: 6px solid var(--color-packing); background: #e8f5e9;}
    .campo-shipping {border-left: 6px solid var(--color-shipping); background: #fffde7;}
    .campo-retiro {border-left: 6px solid var(--color-retiro); background: #e0f7fa;}
    .campo-putwall {border-left: 6px solid var(--color-putwall); background: #f3e5f5;}
    .campo-putaway {border-left: 6px solid var(--color-putaway); background: #fbe9e7;}
    .campo-returns {border-left: 6px solid var(--color-returns); background: #ffebee;}
    .campo-inventario {border-left: 6px solid var(--color-inventario); background: #eceff1;}
    .campo-qualidade {border-left: 6px solid var(--color-qualidade); background: #e3f2fd;}
    .campo-indiretos-picking {border-left: 6px solid var(--color-indiretos-picking); background: #efebe9;}


    label {
      font-weight: 700;
      color: #222e;
      font-size: 1.08em;
      font-family: 'Montserrat', sans-serif;
      margin-right: 0.5em;
      margin-bottom: 0;
    }
    .campo-t1 label { color: var(--num-t1); }
    .campo-t2 label { color: var(--num-t2); }
    .campo-t3 label { color: var(--num-t3); }
    .campo-t4 label { color: var(--num-t4); }
    .campo-t5 label { color: var(--num-t5); }
    .campo-sauron label { color: var(--sauron);}
    .campo-emprestado label { color: var(--num-info);} /* Cor da label para RFs emprestados */

    /* Cores das labels para as novas áreas */
    .campo-packing label { color: var(--color-packing); }
    .campo-shipping label { color: var(--color-shipping); }
    .campo-retiro label { color: var(--color-retiro); }
    .campo-putwall label { color: var(--color-putwall); }
    .campo-putaway label { color: var(--color-putaway); }
    .campo-returns label { color: var(--color-returns); }
    .campo-inventario label { color: var(--color-inventario); }
    .campo-qualidade label { color: var(--color-qualidade); }
    .campo-indiretos-picking label { color: var(--color-indiretos-picking); }


    .entrada-input,
    .manut-input,
    .emprestado-input, /* Adicionado .emprestado-input */
    .area-input { /* Nova classe para os inputs das áreas */
      width: 67px;
      font-size: 1.17em;
      border: 1.7px solid var(--border-dark);
      border-radius:6px;
      background: #f9fbff;
      color: #1d2432;
      font-weight: bold;
      padding: 5px 12px 5px 12px;
      font-family: inherit;
      margin-left: 9px;
      box-shadow:0 1px 4px #b2b5fe18 inset;
      transition: border var(--tr), box-shadow var(--tr), background var(--tr);
    }
    .entrada-input:focus,
    .manut-input:focus,
    .emprestado-input:focus, /* Adicionado .emprestado-input:focus */
    .area-input:focus { /* Nova classe para os inputs das áreas */
      outline: none;
      border-color: var(--num-t4);
      background: #e3f5fd;
      box-shadow:0 2px 9px #77acf830;
    }
    .resultsDMO {
      margin-top:12px;
      display:flex;
      flex-direction:column;
      gap: 9px;
    }
    .resultDMO {
      display:flex;
      justify-content:space-between;
      align-items:center;
      font-size:1.10em;
      background: #f7fafd;
      border-radius:7px;
      padding:8px 16px 7px 15px;
      font-weight: 600;
      color: var(--text);
      margin-bottom:2px;
      border-left: 5px solid var(--num-info);
      box-shadow: 0 2px 6px #bbcfff13;
      border:1.3px solid var(--border-dark);
      transition: border var(--tr), box-shadow var(--tr), background var(--tr);
    }
    .resultDMO.r-info      { border-left: 5px solid var(--num-info);}
    .resultDMO.r-dang      { border-left: 5px solid var(--num-alt);}
    .resultDMO.r-suc       { border-left: 5px solid var(--num-ok);}
    .resultDMO.r-warn      { border-left: 5px solid var(--num-warn);}
    .resultDMO strong { font-weight: 900; color: #16244c; }
    .resultDMO .num {
      font-size: 1.44em;
      line-height:.99em;
      font-weight: 900;
      font-family: 'Montserrat', Arial, sans-serif;
      color: var(--num-info);
      margin-left:12px;
      background: none !important;
      text-shadow: 0 2px 6px #bdfbf699;
    }
    .resultDMO.r-dang .num { color: var(--num-alt);}
    .resultDMO.r-suc  .num { color: var(--num-ok);}
    .resultDMO.r-info  .num { color: var(--num-info);}
    .resultDMO.r-warn .num { color: var(--num-warn);}
    .picking-destaque {
      border: 2.5px solid var(--num-ok);
      background: linear-gradient(105deg,#eaf4ff 60%,#eafdfe 100%);
      box-shadow: 0 4px 12px #b6d7fb24;
      z-index: 2;
      border-radius: 7px;
      margin-bottom:0;
    }
    .hc-field {
      display: flex;
      flex-direction: column;
      margin-bottom: 3.5px;
      background: #eaf4ff;
      border: 1.7px solid #90caf9;
      border-left: 5px solid var(--num-ok);
      border-radius: 6px;
      padding: 8px 12px;
      box-shadow: 0 2px 6px #b2cbff19;
      transition: border var(--tr), box-shadow var(--tr), background var(--tr);
    }
    .hc-field label {
      font-size: 1.07em;
      color: var(--num-ok);
      margin-bottom: 1px;
    }
    .hc-field input{
      background: #fff;
      border: 1.5px solid #90caf9;
      padding-left: 10px;
      color: #1e293b;
      font-weight: bold;
      font-size: 1.09em;
      border-radius: 6px;
      margin-top: 2px;
      width: 68px;
      box-shadow: 0 1.5px 6px #b6d7fb19 inset;
      transition: border var(--tr), box-shadow var(--tr), background var(--tr);
    }
    .hc-field input:focus {
      border: 1.5px solid #554eee;
      background: #e8eefd;
      outline: none;
      box-shadow:0 3px 16px #b2b5fe25;
    }
    .manut-card {
      border-left: 6px solid #c2a22b;
      background: #fcf7e1;
      box-shadow: 0 2px 19px #dac88416;
      margin-bottom:0;
    }
    .manut-label {
      font-size: 1.14em;
      color: #a18613;
      font-weight: bold;
      letter-spacing: .8px;
      font-family: 'Montserrat', Arial, sans-serif;
      margin-bottom: 8px;
    }
    .manut-input {
      width: 68px;
      background: #fffccf;
      border: 1.6px solid #dac884;
      border-radius: 8px;
      font-size: 1.12em;
      font-family: inherit;
      color: #937f18;
      font-weight: bold;
      padding: 4px 13px 4px 10px;
      margin-left: 9px;
      box-shadow:0 1px 4px #dac8841e inset;
      transition: border var(--tr), box-shadow var(--tr), background var(--tr);
    }
    .manut-input:focus {
      border-color:#bfa417;
      outline: none;
      background: #e9e3be;
    }

    /* Novo estilo para RFs emprestados (geral) */
    .emprestado-card {
      border-left: 6px solid var(--num-info);
      background: #e6f7ff;
      box-shadow: 0 2px 19px #b2d6f216;
      margin-bottom:0;
    }
    .emprestado-label {
      font-size: 1.14em;
      color: var(--num-info);
      font-weight: bold;
      letter-spacing: .8px;
      font-family: 'Montserrat', Arial, sans-serif;
      margin-bottom: 8px;
    }
    /* Estilo para os inputs das áreas */
    .area-input {
      background: #f0f8ff; /* Fundo padrão mais claro para os inputs de área */
      border: 1.6px solid var(--border-dark); /* Borda padrão mais escura */
      border-radius: 8px;
      font-size: 1.12em;
      font-family: inherit;
      color: #245392; /* Cor de texto padrão para inputs de área */
      font-weight: bold;
      padding: 4px 13px 4px 10px;
      margin-left: 9px;
      box-shadow:0 1px 4px rgba(0, 0, 0, 0.05) inset;
      transition: border var(--tr), box-shadow var(--tr), background var(--tr);
    }
    .area-input:focus {
      border-color: var(--num-info); /* Cor da borda ao focar */
      outline: none;
      background: #d9edf8; /* Fundo ao focar */
    }


    .resumo-side {
      display: none;
      position: fixed;
      box-shadow: 0 8px 44px #554eee38, 0 2px 8px #b8b5f333;
      z-index: 1002;
      background: #fafafd;
      border: 2.6px solid var(--sauron);
      border-radius: 13px;
      padding: 30px;
      flex-direction: column;
      gap: 15px;
      min-width: 320px;
      max-width:98vw;
      outline:none;
      transition: box-shadow var(--tr), border-color var(--tr), background var(--tr);
      overflow-y: auto;
      left: 50%;
      transform: translateX(-50%);
      top: 50%;
      transform: translate(-50%, -50%);
      height: auto;
      max-height: 90vh;
    }
    .resumo-side.active {
      display: flex;
    }
    .resumo-title {
      font-size:1.5em;
      color:var(--sauron);
      font-weight:900;
      letter-spacing:1.4px;
      font-family:'Montserrat',Arial,sans-serif;
      text-shadow:0 3px 15px #554eee28;
      margin-bottom:15px;
      text-align:left;
    }
    .resumo-datahora {
      font-size:.99em;
      letter-spacing:.5px;
      color: #8686b0;
      margin-bottom:15px;
      padding-bottom:8px;
      border-bottom: 1.2px dotted #dddffa;
      font-family:'Quicksand','Montserrat',sans-serif;
    }
    .resumo-items {
      display:flex;
      flex-direction: column;
      gap:18px;
    }
    .resumo-row {
      font-size:1.05em;
      display:flex;align-items: center;justify-content:space-between;
      padding:10px 0;
      border-bottom: 1px solid #eceefe;
      font-family: 'Montserrat',Arial,sans-serif;
      transition:background var(--tr);
    }
    .resumo-row:hover { background: #efedfe55;}
    .resumo-label {
      color: #616199;
      font-weight:700;
      letter-spacing:.4px;
    }
    .resumo-value {
      color: #242464;
      font-weight:900;
      font-size:1.2em;
      display:inline-block;
      min-width:52px;
      letter-spacing:1.1px;
      text-align: right;
    }
    .resumo-value.sauron {color: var(--sauron);}
    .resumo-value.ok {color: var(--num-ok);}
    .resumo-value.alt {color: var(--num-alt);}
    .resumo-value.info {color: var(--num-info);} /* Para o total de emprestados */

    /* Cores dos valores no resumo */
    .resumo-value.packing { color: var(--color-packing); }
    .resumo-value.shipping { color: var(--color-shipping); }
    .resumo-value.retiro { color: var(--color-retiro); }
    .resumo-value.putwall { color: var(--color-putwall); }
    .resumo-value.putaway { color: var(--color-putaway); }
    .resumo-value.returns { color: var(--color-returns); }
    .resumo-value.inventario { color: var(--color-inventario); }
    .resumo-value.qualidade { color: var(--color-qualidade); }
    .resumo-value.indiretos-picking { color: var(--color-indiretos-picking); }

    .resumo-close-btn {
      position:absolute;
      top:10px;
      right:10px;
      background: none;
      border:none;
      color: #554eee;
      font-size: 1.8em;
      font-weight:900;
      cursor:pointer;
      line-height:1;
      padding:0;
      transition:.18s;
      z-index:10;
      text-shadow: 0 2px 12px #b2b1ff48;
    }
    .resumo-close-btn:hover, .resumo-close-btn:focus {
      color: #20116e;
      background: #ececff;
      box-shadow:0 2px 18px #b2b1ff25;
    }
    .resumo-prev {
      font-size:1.05em;
      padding:10px 14px;
      background:#f6f6ff;
      color:var(--num-warn);
      border:1.6px dashed #a1a1ff3b;
      border-radius: 8px;
      margin: 10px 0 0 0;
      font-weight:700;
      text-align:center;
      letter-spacing:.7px;
    }
    .resumo-overlay {
      position:fixed;
      top:0;left:0;width:100vw;height:100vh;
      z-index:1001;
      background:rgba(40,36,94,0.096);
      backdrop-filter: blur(4.5px);
      display:none;
      opacity:1;
      transition:.22s;
    }
    .resumo-overlay.active {
      display:block;
      opacity:1;
    }
    footer {
      text-align:center;
      color:#65629b;
      font-size: 1.01em;
      letter-spacing: .8px;
      margin: 40px auto 24px auto;
      font-family: 'Montserrat', 'Quicksand', Arial, sans-serif;
      opacity: .95;
      text-shadow:0 1.5px 1.5px #e0dfff1a;
    }
    @media (max-width:700px) {
      html,body{font-size:14px;}
      .resumo-side {width:97vw;padding:20px;}
      .resumo-title{font-size:1.17em;}
      .resumo-row{font-size:1em;padding:8px 0;}
      .top-bar {flex-direction: column; align-items: stretch; padding: 10px;}
      header {padding: 10px 0; font-size: 1.7rem; text-align: left;}
      .top-highlight-sauron-num { font-size: 3em; }
    }
  </style>
</head>
<body>
<div class="top-bar" id="topbarMain">
  <header>GESTÃO DE RFS NO SAURON</header>
  <button class="btn-resumo" id="btnResumo" title="Ver resumo detalhado">
    <span class="ic">📊</span> Resumo Detalhado
  </button>
</div>
<div class="top-highlight-sauron" id="sauronMainBox">
    <div class="top-highlight-sauron-label">TOTAL DE RFs EM SAURON</div>
    <span class="top-highlight-sauron-num" id="rfTotalSauron">0</span>
</div>
<div id="datahora">
  <span class="icone">⏰</span>
  <span id="datahoraConteudo"></span>
</div>
<button class="btn-resumo btn-small" id="btnOutDMO" type="button" style="margin-top:8px; margin-bottom:8px;">
  <span class="ic">📄</span> DMO Outbound | SP04
</button>
<button class="btn-resumo btn-small" id="btnControleRF" type="button" style="margin-bottom:18px;">
  <span class="ic">📋</span> Controle de RF's SP04
</button>
<div class="dashboard-main" id="mainDashboard">
  <div class="accordion">
    <section class="acrd-card">
      <button type="button" class="acrd-header collapsed" aria-expanded="false">
        <span class="arrow">▼</span> RFs para Entrada
      </button>
      <div class="acrd-body" style="display:none;">
        <div class="fieldsetDMO" style="gap:18px;">
          <div class="campo-t1">
            <label for="rfT1">RFs Disponíveis Para Entrada do T1</label>
            <input type="number" id="rfT1" class="entrada-input" value="0" min="0">
          </div>
          <div class="campo-t2">
            <label for="rfT2">RFs Disponíveis Para Entrada do T2</label>
            <input type="number" id="rfT2" class="entrada-input" value="0" min="0">
          </div>
          <div class="campo-t3">
            <label for="rfT3">RFs Disponíveis Para Entrada do T3</label>
            <input type="number" id="rfT3" class="entrada-input" value="0" min="0">
          </div>
          <div class="campo-t4">
            <label for="rfT4">RFs Disponíveis Para Entrada do T4</label>
            <input type="number" id="rfT4" class="entrada-input" value="0" min="0">
          </div>
          <div class="campo-t5">
            <label for="rfT5">RFs Disponíveis Para Entrada do T5</label>
            <input type="number" id="rfT5" class="entrada-input" value="0" min="0">
          </div>
          <div class="campo-sauron">
            <label for="rfSauron">RFs em Sauron Para Movimentação</label>
            <input type="number" id="rfSauron" class="entrada-input" value="0" min="0">
          </div>
        </div>
      </div>
    </section>

    <section class="acrd-card">
      <button type="button" class="acrd-header collapsed" aria-expanded="false">
        <span class="arrow">▼</span> HCs Previstos para Picking
      </button>
      <div class="acrd-body" style="display:none;">
        <div class="fieldsetDMO" style="gap:12px;">
          <div class="hc-field">
            <label for="hcsPrevT1Picking"><b>HCs Prev. T1 Picking</b></label>
            <input type="number" id="hcsPrevT1Picking" value="0" min="0">
          </div>
          <div class="hc-field">
            <label for="hcsPrevT2Picking"><b>HCs Prev. T2 Picking</b></label>
            <input type="number" id="hcsPrevT2Picking" value="0" min="0">
          </div>
          <div class="hc-field">
            <label for="hcsPrevT3Picking"><b>HCs Prev. T3 Picking</b></label>
            <input type="number" id="hcsPrevT3Picking" value="0" min="0">
          </div>
          <div class="hc-field">
            <label for="hcsPrevT4Picking"><b>HCs Prev. T4 Picking</b></label>
            <input type="number" id="hcsPrevT4Picking" value="0" min="0">
          </div>
          <div class="hc-field">
            <label for="hcsPrevT5Picking"><b>HCs Prev. T5 Picking</b></label>
            <input type="number" id="hcsPrevT5Picking" value="0" min="0">
          </div>
        </div>
      </div>
    </section>

    <section class="acrd-card">
      <button type="button" class="acrd-header collapsed" aria-expanded="false">
        <span class="arrow">▼</span> HCs Previstos para Transfer (MWH)
      </button>
      <div class="acrd-body" style="display:none;">
        <div class="fieldsetDMO" style="gap:12px;">
          <div class="hc-field">
            <label for="hcsPrevT1Transfer"><b>HCs Prev. T1 Transfer</b></label>
            <input type="number" id="hcsPrevT1Transfer" value="0" min="0">
          </div>
          <div class="hc-field">
            <label for="hcsPrevT2Transfer"><b>HCs Prev. T2 Transfer</b></label>
            <input type="number" id="hcsPrevT2Transfer" value="0" min="0">
          </div>
          <div class="hc-field">
            <label for="hcsPrevT3Transfer"><b>HCs Prev. T3 Transfer</b></label>
            <input type="number" id="hcsPrevT3Transfer" value="0" min="0">
          </div>
          <div class="hc-field">
            <label for="hcsPrevT4Transfer"><b>HCs Prev. T4 Transfer</b></label>
            <input type="number" id="hcsPrevT4Transfer" value="0" min="0">
          </div>
          <div class="hc-field">
            <label for="hcsPrevT5Transfer"><b>HCs Prev. T5 Transfer</b></label>
            <input type="number" id="hcsPrevT5Transfer" value="0" min="0">
          </div>
        </div>
      </div>
    </section>

    <section class="acrd-card">
      <button type="button" class="acrd-header collapsed" aria-expanded="false">
        <span class="arrow">▼</span> RFs Emprestados (Outros Setores)
      </button>
      <div class="acrd-body" style="display:none;">
        <div class="fieldsetDMO" style="gap:18px;">
          <div class="campo-packing">
            <label for="rfPacking">RFs - Packing</label>
            <input type="number" id="rfPacking" class="area-input" value="0" min="0">
          </div>
          <div class="campo-shipping">
            <label for="rfShipping">RFs - Shipping</label>
            <input type="number" id="rfShipping" class="area-input" value="0" min="0">
          </div>
          <div class="campo-retiro">
            <label for="rfRetiro">RFs - Retiro</label>
            <input type="number" id="rfRetiro" class="area-input" value="0" min="0">
          </div>
          <div class="campo-putwall">
            <label for="rfPutWall">RFs - PutWall</label>
            <input type="number" id="rfPutWall" class="area-input" value="0" min="0">
          </div>
          <div class="campo-putaway">
            <label for="rfPutAway">RFs - PutAway</label>
            <input type="number" id="rfPutAway" class="area-input" value="0" min="0">
          </div>
          <div class="campo-returns">
            <label for="rfReturns">RFs - Returns</label>
            <input type="number" id="rfReturns" class="area-input" value="0" min="0">
          </div>
          <div class="campo-inventario">
            <label for="rfInventario">RFs - Inventário</label>
            <input type="number" id="rfInventario" class="area-input" value="0" min="0">
          </div>
          <div class="campo-qualidade">
            <label for="rfQualidade">RFs - Qualidade</label>
            <input type="number" id="rfQualidade" class="area-input" value="0" min="0">
          </div>
          <div class="campo-indiretos-picking">
            <label for="rfIndiretosPicking">RFs - Indiretos Picking</label>
            <input type="number" id="rfIndiretosPicking" class="area-input" value="0" min="0">
          </div>
        </div>
      </div>
    </section>
    <section class="acrd-card">
      <button type="button" class="acrd-header collapsed" aria-expanded="false">
        <span class="arrow">▼</span> RFs para Manutenção
      </button>
      <div class="acrd-body" style="display:none;">
        <div class="fieldsetDMO">
          <label class="manut-label" for="rfManut">RFs para Manutenção</label>
          <input type="number" id="rfManut" class="manut-input" value="0" min="0">
        </div>
      </div>
    </section>
    <section class="acrd-card">
      <button type="button" class="acrd-header collapsed" aria-expanded="false">
        <span class="arrow">▼</span> Situação Geral
      </button>
      <div class="acrd-body" style="display:none;">
        <div class="resultsDMO">
          <div class="resultDMO r-suc">
            <strong>Total RFs Operação</strong>
            <span class="num" id="totalRfsOperacao">0</span>
          </div>
          </div>
      </div>
    </section>
  </div>
</div>

<div class="resumo-overlay" id="resumoOverlay"></div>
<aside class="resumo-side" id="resumoSide" tabindex="-1" aria-hidden="true" aria-label="Resumo detalhado">
  <button class="resumo-close-btn" title="Fechar resumo" id="fecharResumo" aria-label="Fechar resumo">&times;</button>
  <div class="resumo-title">Resumo Detalhado</div>
  <div class="resumo-datahora" id="resumoDataHora"></div>
  <div class="resumo-items" id="resumoItems">
    <div class="resumo-row">
      <span class="resumo-label">Total de RFs no Sauron</span>
      <span class="resumo-value sauron" id="resumoRFSauron">0</span>
    </div>
    <div class="resumo-row">
      <span class="resumo-label">RFs para Manutenção</span>
      <span class="resumo-value alt" id="resumoManut">Não</span>
    </div>
    <div class="resumo-row">
      <span class="resumo-label">Total RFs Emprestados</span>
      <span class="resumo-value info" id="resumoTotalEmprestado">0</span>
    </div>
    <div class="resumo-prev" id="resumoPrevBox" style="display:none;"></div>
    <div class="resumo-row" id="resumoPrevDiffRow" style="display:none;">
      <span class="resumo-label" id="resumoPrevDiffLabel"></span>
      <span class="resumo-value" id="resumoPrevDiffValue"></span>
    </div>
  </div>
</aside>

<footer>
  <a href="https://www.linkedin.com/in/patrick-a-786689211?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app"
      target="_blank" rel="noopener noreferrer"
      style="color:inherit;text-decoration:underline;font-weight:700;cursor:pointer;">
    Desenvolvido por Patrick Alves De Oliveira Maciel
  </a>
</footer>

<script>
function $(id){return document.getElementById(id);}
function pad(n){return n<10?'0'+n:n;}
function getNowBR(){
  const d = new Date();
  let h = d.getHours(), m = d.getMinutes(), s = d.getSeconds();
  return {
    date: pad(d.getDate())+"/"+pad(d.getMonth()+1)+"/"+d.getFullYear(),
    time: pad(h)+":"+pad(m)+":"+pad(s),
    hour: h, min: m
  };
}

// Novos arrays para datas por extenso
const DIAS = ['domingo','segunda-feira','terça-feira','quarta-feira','quinta-feira','sexta-feira','sábado'];
const MESES = ['janeiro','fevereiro','março','abril','maio','junho','julho','agosto','setembro','outubro','novembro','dezembro'];

// Função formatada bonita
function getDateHoraFullBR(){
  const d = new Date();
  let dia = DIAS[d.getDay()];
  let nDia = d.getDate();
  let mes = MESES[d.getMonth()];
  let ano = d.getFullYear();
  let h = ('0'+d.getHours()).slice(-2), m = ('0'+d.getMinutes()).slice(-2), s = ('0'+d.getSeconds()).slice(-2);
  // Exemplo: terça-feira, 11 de junho de 2024 • 10:58:15
  return `${dia.charAt(0).toUpperCase() + dia.slice(1)}, ${nDia} de ${mes} de ${ano} &bull; ${h}:${m}:${s}`;
}

// Atualiza data/hora com novo visual
function updateDateHour(){
  $("datahoraConteudo").innerHTML = getDateHoraFullBR();
  $("resumoDataHora").innerHTML = getDateHoraFullBR();
}

function calcDMO() {
  let rfT1 = +$("rfT1").value||0,
      rfT2 = +$("rfT2").value||0,
      rfT3 = +$("rfT3").value||0,
      rfT4 = +$("rfT4").value||0,
      rfT5 = +$("rfT5").value||0,
      rfSauron = +$("rfSauron").value||0;
  let hcsPrevT1Picking = +$("hcsPrevT1Picking").value||0,
      hcsPrevT2Picking = +$("hcsPrevT2Picking").value||0,
      hcsPrevT3Picking = +$("hcsPrevT3Picking").value||0,
      hcsPrevT4Picking = +$("hcsPrevT4Picking").value||0,
      hcsPrevT5Picking = +$("hcsPrevT5Picking").value||0;
  let hcsPrevT1Transfer = +$("hcsPrevT1Transfer").value||0,
      hcsPrevT2Transfer = +$("hcsPrevT2Transfer").value||0,
      hcsPrevT3Transfer = +$("hcsPrevT3Transfer").value||0,
      hcsPrevT4Transfer = +$("hcsPrevT4Transfer").value||0,
      hcsPrevT5Transfer = +$("hcsPrevT5Transfer").value||0;
  let rfManut = +$("rfManut").value||0;
  
  // Novas variáveis para RFs Emprestados por área
  let rfPacking = +$("rfPacking").value||0;
  let rfShipping = +$("rfShipping").value||0;
  let rfRetiro = +$("rfRetiro").value||0;
  let rfPutWall = +$("rfPutWall").value||0;
  let rfPutAway = +$("rfPutAway").value||0;
  let rfReturns = +$("rfReturns").value||0;
  let rfInventario = +$("rfInventario").value||0;
  let rfQualidade = +$("rfQualidade").value||0;
  let rfIndiretosPicking = +$("rfIndiretosPicking").value||0;

  let totalRfEmprestado = rfPacking + rfShipping + rfRetiro + rfPutWall + rfPutAway + rfReturns + rfInventario + rfQualidade + rfIndiretosPicking;

  let rfTotalSauron = rfT1 + rfT2 + rfT3 + rfT4 + rfT5 + rfSauron;
  let totalHcsPicking = hcsPrevT1Picking + hcsPrevT2Picking + hcsPrevT3Picking + hcsPrevT4Picking + hcsPrevT5Picking;
  let totalHcsTransfer = hcsPrevT1Transfer + hcsPrevT2Transfer + hcsPrevT3Transfer + hcsPrevT4Transfer + hcsPrevT5Transfer;
  // let totalRepsHoraPico = totalHcsPicking + totalHcsTransfer; // Esta linha foi removida

  // AQUI: Adiciona o totalRfEmprestado ao totalRfsOperacao
  let totalRfsOperacao = rfTotalSauron + totalRfEmprestado; 
  
  // Atualiza os valores na tela
  $("rfTotalSauron").textContent = rfTotalSauron;
  // $("totalRepsHoraPico").textContent = totalRepsHoraPico; // Esta linha foi removida
  $("totalRfsOperacao").textContent = totalRfsOperacao; 
  $("resumoRFSauron").textContent = rfTotalSauron;
  // $("resumoTotalPicking").textContent = totalRepsHoraPico; // Esta linha foi removida
  $("resumoManut").textContent = rfManut > 0 ? `${rfManut} RF${rfManut>1?'s':''}` : "Não";
  $("resumoTotalEmprestado").textContent = totalRfEmprestado; // Atualiza o resumo para o total de RFs Emprestados

  const now = getNowBR();
  let prevMsg = "";
  let show = false;
  let diffLabel = "";
  let diffValue = "";
  let diffShow = false;
  let hcsPrevTurno = 0;
  if ((now.hour === 4 && now.min >= 30) || (now.hour === 5 && now.min <= 59)) {
      hcsPrevTurno = hcsPrevT1Picking + hcsPrevT1Transfer;
      prevMsg = `Previsão T1: <span style="color:var(--num-t1);font-weight:800;">${hcsPrevTurno}</span> HCs`;
      show = true;
  } else if ((now.hour === 10 && now.min >= 1) || (now.hour > 10 && now.hour < 14) || (now.hour === 14 && now.min <= 6)){
      hcsPrevTurno = hcsPrevT2Picking + hcsPrevT2Transfer;
      prevMsg = `Previsão T2: <span style="color:var(--num-t2);font-weight:800;">${hcsPrevTurno}</span> HCs`;
      show = true;
  } else if ((now.hour === 21 && now.min >= 0) || (now.hour === 22 && now.min <= 59)) {
      hcsPrevTurno = hcsPrevT3Picking + hcsPrevT3Transfer;
      prevMsg = `Previsão T3: <span style="color:var(--num-t3);font-weight:800;">${hcsPrevTurno}</span> HCs`;
      show = true;
  } else if ((now.hour >= 6 && now.hour < 10) || (now.hour === 10 && now.min === 0)) {
      hcsPrevTurno = hcsPrevT4Picking + hcsPrevT4Transfer;
      prevMsg = `Previsão T4: <span style="color:var(--num-t4);font-weight:800;">${hcsPrevTurno}</span> HCs`;
      show = true;
  } else if ((now.hour === 14 && now.min >= 7) || (now.hour > 14 && now.hour < 20) || (now.hour === 20 && now.min <= 59)){
      hcsPrevTurno = hcsPrevT5Picking + hcsPrevT5Transfer;
      prevMsg = `Previsão T5: <span style="color:var(--num-t5);font-weight:800;">${hcsPrevTurno}</span> HCs`;
      show = true;
  }
  if (show) {
      $("resumoPrevBox").innerHTML = prevMsg;
      $("resumoPrevBox").style.display = "block";
      const diff = rfTotalSauron - hcsPrevTurno;
      if (diff >= 0) {
          diffLabel = "RFs Sobrando";
          diffValue = `+${diff}`;
          $("resumoPrevDiffValue").className = "resumo-value ok";
      } else {
          diffLabel = "RFs Faltando";
          diffValue = `${diff}`;
          $("resumoPrevDiffValue").className = "resumo-value alt";
      }
      $("resumoPrevDiffLabel").textContent = diffLabel;
      $("resumoPrevDiffValue").textContent = diffValue;
      $("resumoPrevDiffRow").style.display = "flex";
      diffShow = true;
  } else {
      $("resumoPrevBox").style.display = "none";
      $("resumoPrevDiffRow").style.display = "none";
  }
}
document.addEventListener('DOMContentLoaded', () => {
  updateDateHour();
  calcDMO();
  setInterval(updateDateHour, 5000);
  document.querySelectorAll('.acrd-header').forEach(header => {
    header.addEventListener('click', () => {
      const currentActive = document.querySelector('.acrd-card.active');
      const parentCard = header.closest('.acrd-card');
      const body = header.nextElementSibling;
      if (parentCard.classList.contains('active')) {
        parentCard.classList.remove('active');
        header.classList.add('collapsed');
        header.setAttribute('aria-expanded', 'false');
        body.style.display = 'none';
      } else {
        if (currentActive) {
          currentActive.classList.remove('active');
          currentActive.querySelector('.acrd-header').classList.add('collapsed');
          currentActive.querySelector('.acrd-header').setAttribute('aria-expanded', 'false');
          currentActive.querySelector('.acrd-body').style.display = 'none';
        }
        parentCard.classList.add('active');
        header.classList.remove('collapsed');
        header.setAttribute('aria-expanded', 'true');
        body.style.display = 'block';
      }
    });
  });
  document.querySelectorAll('.entrada-input, .manut-input, .hc-field input, .area-input').forEach(input => { 
    input.addEventListener('input', calcDMO);
  });
  const resumoSide = $("resumoSide");
  const resumoOverlay = $("resumoOverlay");
  const btnResumo = $("btnResumo");
  const fecharResumo = $("fecharResumo");
  const mainDashboard = $("mainDashboard");
  const topbarMain = $("topbarMain");
  const sauronMainBox = $("sauronMainBox");
  const datahoraBox = $("datahora");
  function openResumo() {
    resumoSide.classList.add('active');
    resumoOverlay.classList.add('active');
    mainDashboard.classList.add('blurred');
    topbarMain.classList.add('blurred');
    sauronMainBox.classList.add('blurred');
    datahoraBox.classList.add('blurred');
    resumoSide.focus();
  }
  function closeResumo() {
    resumoSide.classList.remove('active');
    resumoOverlay.classList.remove('active');
    mainDashboard.classList.remove('blurred');
    topbarMain.classList.remove('blurred');
    sauronMainBox.classList.remove('blurred');
    datahoraBox.classList.remove('blurred');
  }
  btnResumo.addEventListener('click', openResumo);
  fecharResumo.addEventListener('click', closeResumo);
  resumoOverlay.addEventListener('click', closeResumo);
  resumoSide.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
      closeResumo();
    }
  });
  // Botão DMO Outbound | SP04
  const btnOutDMO = document.getElementById('btnOutDMO');
  if (btnOutDMO) {
    btnOutDMO.onclick = function() {
      window.open('https://docs.google.com/spreadsheets/d/1kRA3lTMNNG8sOaKUdhYzTeNpT_pUIywfTmuyyvsHcUU/edit?gid=2128228084#gid=2128228084', '_blank');
    };
  }
  // Botão Controle de RF's SP04
  const btnControleRF = document.getElementById('btnControleRF');
  if (btnControleRF) {
    btnControleRF.onclick = function() {
      window.open('https://docs.google.com/spreadsheets/d/1wBdP2z1F5yaxXZVfYcB9_bPna_9-wHw3-S5476aqEYo/edit?gid=717969347#gid=717969347', '_blank');
    };
  }
});
</script>
</body>
</html>
